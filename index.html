<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>مساعد مطعم ميدو ملك البسترما</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body style="font-family: Arial, sans-serif;">

    <header>
        <h1>مرحبًا بك في مطعم ميدو ملك البسترما!</h1>
        <p>أنا هنا للمساعدة في اختيار طلبك والرد على استفساراتك. كيف يمكنني مساعدتك اليوم؟</p>
    </header>

    <section id="chatbox">
        <div id="messages"></div>
        <input type="text" id="userInput" placeholder="أدخل طلبك هنا..." />
        <button onclick="sendMessage()">إرسال</button>
    </section>

    <script>
        const messagesDiv = document.getElementById("messages");
        const userInput = document.getElementById("userInput");

        async function sendMessage() {
            const inputText = userInput.value.trim();
            if (!inputText) return;

            // عرض رسالة المستخدم
            messagesDiv.innerHTML += `<p><strong>أنت:</strong> ${inputText}</p>`;
            userInput.value = "";

            // استدعاء API الخاص بـ OpenAI
            const response = await getOpenAIResponse(inputText);
            messagesDiv.innerHTML += `<p><strong>مساعد ميدو:</strong> ${response}</p>`;
        }

        async function getOpenAIResponse(inputText) {
            const prompt = `
                أنت المساعد الذكي لمطعم "ميدو ملك البسترما" في لبنان.
                تحدث باللهجة اللبنانية الودودة والمحترمة.
                زبون قال: "${inputText}"
                رد عليه بشكل مناسب.

                معلومات المطعم:
                - الموقع: الشياح - طريق صيدا القديمة.
                - الفروع الأخرى: خلدة، الجيّة.
                - الدوام: يومياً من 10 صباحاً حتى 11:30 ليلاً.
                - اللحمة: طازجة وحلال 100%.
                - الدليفري: متوفر لكل بيروت.
            `;

            try {
                const result = await axios.post('https://api.openai.com/v1/completions', {
                    model: "gpt-3.5-turbo",
                    prompt: prompt,
                    max_tokens: 150,
                    temperature: 0.7,
                    n: 1
                }, {
                    headers: {
                        "Content-Type": "application/json",
                        "Authorization": `Bearer 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`
                    }
                });

                return result.data.choices[0].text.trim();
            } catch (error) {
                console.error('Error:', error);
                return "عذراً، حدث خطأ في التواصل مع المساعد.";
            }
        }
    </script>

</body>
</html>