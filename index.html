<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ØªØ¬Ø±Ø¨Ø© Ù…Ø³Ø§Ø¹Ø¯ Ù…ÙŠØ¯Ùˆ Ø§Ù„Ø°ÙƒÙŠ</title>
  <style>
    body { font-family: sans-serif; background: #f0f0f0; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
    
    /* ØªØµÙ…ÙŠÙ… Ø§Ù„Ø´Ø§Øª */
    .chat-box {
      width: 350px; height: 500px; background: white;
      border: 2px solid #bf360c; border-radius: 15px;
      display: flex; flex-direction: column;
      box-shadow: 0 10px 25px rgba(0,0,0,0.2);
    }
    .chat-header {
      background: #bf360c; color: white; padding: 15px;
      font-weight: bold; text-align: center; font-size: 1.2em;
    }
    .chat-body {
      flex: 1; padding: 15px; overflow-y: auto; background: #fff8e1;
      display: flex; flex-direction: column; gap: 10px;
    }
    .message {
      padding: 10px 15px; border-radius: 15px; width: fit-content;
      max-width: 80%; font-size: 0.95em; line-height: 1.4;
    }
    .bot-msg { background: #fff; align-self: flex-end; border: 1px solid #ddd; border-top-right-radius: 2px; }
    .user-msg { background: #bf360c; color: white; align-self: flex-start; border-top-left-radius: 2px; }
    
    .chat-footer { padding: 10px; background: #fff; border-top: 1px solid #ddd; display: flex; gap: 5px; }
    .chat-footer input { flex: 1; padding: 10px; border: 1px solid #ccc; border-radius: 25px; outline: none; }
    .chat-footer button {
      background: #bf360c; color: white; border: none; width: 40px; height: 40px;
      border-radius: 50%; cursor: pointer; font-size: 1.2em;
    }
  </style>
</head>
<body>

<div class="chat-box">
  <div class="chat-header">ğŸ¤– ØªØ¬Ø±Ø¨Ø© Ù…Ø³Ø§Ø¹Ø¯ Ù…ÙŠØ¯Ùˆ</div>
  <div class="chat-body" id="chatBody">
    <div class="message bot-msg">Ø£Ù‡Ù„Ø§Ù‹ ÙŠØ§ ØºØ§Ù„ÙŠ! Ø¬Ø±Ø¨Ù†ÙŠ ÙˆØ§Ø³Ø£Ù„Ù†ÙŠ Ø¹Ù† Ø§Ù„Ù…Ù†ÙŠÙˆ Ø£Ùˆ Ø§Ù„Ø£Ø³Ø¹Ø§Ø±ØŸ</div>
  </div>
  <div class="chat-footer">
    <input type="text" id="userInput" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ..." onkeypress="handleEnter(event)">
    <button onclick="sendMessage()">â¤</button>
  </div>
</div>

<script>
  // Ù…ÙØªØ§Ø­Ùƒ
  const API_KEY = "AIzaSyBpb4tW1ZgW4g0tQnwSeXJ3ahIYTI46mzo";

  // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø·Ø¹Ù… (Ø¹Ù‚Ù„ Ø§Ù„Ø¨ÙˆØª)
  const SYSTEM_PROMPT = `
  Ø£Ù†Øª Ù…Ø³Ø§Ø¹Ø¯ Ù…Ø·Ø¹Ù… "Ù…ÙŠØ¯Ùˆ Ù…Ù„Ùƒ Ø§Ù„Ø¨Ø³ØªØ±Ù…Ø§".
  ØªØ­Ø¯Ø« Ø¨Ù„Ù‡Ø¬Ø© Ù„Ø¨Ù†Ø§Ù†ÙŠØ©.
  Ø§Ù„Ù…Ù†ÙŠÙˆ:
  - Ø¨Ø³ØªØ±Ù…Ø§/Ø±ÙˆØ³ØªÙˆ: 400,000
  - Ø³Ø¬Ù‚/Ù…Ù‚Ø§Ù†Ù‚: 350,000
  - Ù‡ÙˆØª Ø¯ÙˆØº: 300,000
  - ÙƒÙŠÙ„Ùˆ Ø¨Ø³ØªØ±Ù…Ø§: 2,400,000
  Ø§Ù„Ù…ÙˆÙ‚Ø¹: Ø§Ù„Ø´ÙŠØ§Ø­.
  `;

  function handleEnter(e) { if(e.key === "Enter") sendMessage(); }

  async function sendMessage() {
    const input = document.getElementById("userInput");
    const txt = input.value.trim();
    if(!txt) return;

    const body = document.getElementById("chatBody");
    // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    body.innerHTML += `<div class="message user-msg">${txt}</div>`;
    input.value = "";
    body.scrollTop = body.scrollHeight;

    // Ø¹Ø±Ø¶ "Ø¬Ø§Ø±ÙŠ Ø§Ù„ÙƒØªØ§Ø¨Ø©"
    const loadingDiv = document.createElement("div");
    loadingDiv.className = "message bot-msg";
    loadingDiv.innerText = "...";
    body.appendChild(loadingDiv);
    body.scrollTop = body.scrollHeight;

    try {
      // Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø¬ÙˆØ¬Ù„
      const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          contents: [{ parts: [{ text: txt }] }],
          systemInstruction: { parts: [{ text: SYSTEM_PROMPT }] }
        })
      });

      const data = await response.json();
      
      // Ø¥Ø²Ø§Ù„Ø© Ù†Ù‚Ø§Ø· Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±
      loadingDiv.remove();

      if (data.error) {
        // ÙÙŠ Ø­Ø§Ù„ ÙˆØ¬ÙˆØ¯ Ø®Ø·Ø£ Ù…Ù† Ø¬ÙˆØ¬Ù„ (Ù…Ø«Ù„Ø§Ù‹ Ø§Ù„Ù…ÙØªØ§Ø­ Ù…Ø­Ø¸ÙˆØ±)
        body.innerHTML += `<div class="message bot-msg" style="color:red">Ø®Ø·Ø£: ${data.error.message}</div>`;
      } else {
        // Ø§Ù„Ù†Ø¬Ø§Ø­
        const reply = data.candidates[0].content.parts[0].text;
        body.innerHTML += `<div class="message bot-msg">${reply}</div>`;
      }

    } catch (error) {
      loadingDiv.remove();
      body.innerHTML += `<div class="message bot-msg" style="color:red">Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„! ØªØ£ÙƒØ¯ Ø£Ù†Ùƒ Ø±ÙØ¹Øª Ø§Ù„Ù…Ù„Ù Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…Ø³Ù…ÙˆØ­ Ø¨Ù‡.</div>`;
      console.error(error);
    }
    
    body.scrollTop = body.scrollHeight;
  }
</script>

</body>
</html>