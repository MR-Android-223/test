<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ù…ÙŠØ¯Ùˆ Ù…Ù„Ùƒ Ø§Ù„Ø¨Ø³ØªØ±Ù…Ø§</title>
  <link rel="icon" href="https://midomido.neocities.org/bastermaa.jpg" type="image/jpeg">
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  
  <style>
    /* === ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø¹Ø§Ù…Ø© === */
    * { margin:0; padding:0; box-sizing:border-box; font-family:'Cairo', sans-serif; }
    body { background-color:#fff3e0; color:#3e2723; line-height:1.6; padding-bottom: 80px; }
    
    header { background-color:#bf360c; color:#fff; padding:25px 0; text-align:center; box-shadow: 0 4px 10px rgba(0,0,0,0.2); }
    header h1 { font-size:2.2em; margin-bottom: 5px; }
    
    /* Ø²Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ */
    .app-download-btn {
      display: inline-block; margin-top: 15px; background-color: #3e2723; color: #fff;
      padding: 12px 30px; border-radius: 50px; text-decoration: none; font-weight: bold; font-size: 1.1em;
      border: 2px solid #fff; box-shadow: 0 4px 15px rgba(0,0,0,0.3);
      transition: transform 0.2s, background 0.3s; animation: pulseBtn 2s infinite; 
    }
    .app-download-btn:hover { background-color: #5d4037; transform: scale(1.05); }
    .app-download-btn i { margin-left: 8px; font-size: 1.2em; }
    @keyframes pulseBtn { 0% { box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.4); } 70% { box-shadow: 0 0 0 10px rgba(255, 255, 255, 0); } 100% { box-shadow: 0 0 0 0 rgba(255, 255, 255, 0); } }

    .category-title { background: #3e2723; color: #fff; display: inline-block; padding: 10px 30px; border-radius: 30px; margin: 40px auto 20px; font-size: 1.5em; box-shadow: 0 4px 10px rgba(0,0,0,0.2); }
    
    /* Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª */
    .products { display:flex; flex-wrap:wrap; justify-content:center; gap:25px; margin-bottom: 30px; padding: 0 15px; }
    .product { background: #fff; border: 2px solid #bf360c; border-radius: 25px; padding: 15px; box-shadow: 0 10px 20px rgba(0,0,0,0.1); transition: transform 0.3s, box-shadow 0.3s; width: 100%; position: relative; overflow: hidden; }
    .product:hover { transform: translateY(-5px); box-shadow: 0 15px 25px rgba(191, 54, 12, 0.2); }
    .product img { width:100%; height:200px; object-fit: contain; border-radius: 15px; margin-bottom: 10px; background-color: #fffbf5; } 
    .product h3 { margin-top:5px; font-size: 1.4em; font-weight: 800; color: #3e2723; }
    
    .kilo-item { display: flex; flex-direction: column; justify-content: center; align-items: center; min-height: 180px; border: 3px double #bf360c; }
    .kilo-item h3 { font-size: 1.6em; margin-bottom: 10px; }

    .price-box { display: flex; justify-content: space-between; align-items: center; background: #fff3e0; padding: 8px 12px; border-radius: 15px; margin: 10px 0 15px; font-weight: 900; border: 1px dashed #bf360c; width: 100%; }
    .price-lbp { color: #bf360c; font-size: 1.1em; }
    .price-usd { color: #2e7d32; font-size: 1.1em; direction: ltr; }

    @media (min-width: 768px) { #sandwichesContainer .product, #drinksContainer .product { width: calc(33.333% - 25px); max-width: 320px; } #kiloContainer .product { width: calc(50% - 25px); max-width: 400px; } }

    .add-btn { background: #3e2723; color: #fff; border: none; padding: 12px; border-radius: 50px; width: 100%; cursor: pointer; font-size: 1.1em; font-weight: bold; transition: background 0.2s, transform 0.1s; }
    .add-btn:active { transform: scale(0.95); }

    /* Modals */
    .modal { display:none; position:fixed; left:0; top:0; width:100%; height:100%; background-color:rgba(0,0,0,0.7); backdrop-filter: blur(4px); overflow: auto; }
    #cartModal { z-index: 3000; } #customizeModal { z-index: 3500; } #weightModal { z-index: 3500; } #clearCartModal { z-index: 4000; } #emptyAlertModal { z-index: 4000; } 
    .modal-content { background-color:#fff; margin:15% auto; padding:25px; border-radius:20px; width:85%; max-width:400px; position: relative; text-align: center; box-shadow: 0 10px 30px rgba(0,0,0,0.3); border: 2px solid #bf360c; }
    .close-btn { float:left; font-size:28px; cursor:pointer; color:#999; }
    .success-icon { font-size: 4em; color: #2e7d32; margin-bottom: 15px; }
    
    .weight-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-top: 15px; }
    .weight-option { background: #fff8e1; border: 2px solid #bf360c; color: #3e2723; padding: 15px; border-radius: 15px; cursor: pointer; font-weight: bold; transition: background 0.2s; }
    .weight-option:hover { background: #bf360c; color: #fff; }

    .ingredient-option { display: flex; justify-content: space-between; align-items: center; padding: 12px; border-bottom: 1px solid #eee; font-size: 1.1em; text-align: right; }
    .ingredient-option input[type="checkbox"] { transform: scale(1.5); accent-color: #2e7d32; }
    
    .cart-float { position: fixed; bottom: 20px; right: 20px; background-color: #bf360c; color: #fff; width: 65px; height: 65px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 28px; cursor: pointer; z-index: 2000; box-shadow: 0 4px 15px rgba(0,0,0,0.4); transition: transform 0.2s; }
    @keyframes cartPulse { 0% { transform: scale(1); background-color: #bf360c; } 50% { transform: scale(1.3) rotate(-10deg); background-color: #2e7d32; } 100% { transform: scale(1); background-color: #bf360c; } }
    .cart-added-animation { animation: cartPulse 0.4s ease-in-out; }
    #cartCount { position: absolute; top: -5px; left: -5px; background: #ffeb3b; color: #bf360c; font-size: 14px; width: 25px; height: 25px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; border: 2px solid #bf360c; }
    .cart-item { border-bottom: 1px dashed #ccc; padding: 10px 0; text-align: right; }
    .cart-notes { font-size: 0.85em; color: #d32f2f; display: block; margin-top: 3px; }
    .whatsapp-checkout { background: #25d366; color: white; border: none; padding: 15px; width: 100%; border-radius: 10px; font-size: 1.1em; font-weight: bold; cursor: pointer; margin-top: 15px; }
    .clear-cart-btn { background: #c62828; color: white; border: none; padding: 8px 15px; border-radius: 10px; cursor: pointer; font-size: 0.9em; margin-top: 10px; }

    .contact-section { background: #fff; padding: 40px 20px; text-align: center; margin-top: 40px; border-top: 5px solid #bf360c; }
    .contact-btn { display: block; width: 100%; max-width: 350px; margin: 10px auto; padding: 15px; color: #fff; border-radius: 10px; text-decoration: none; font-weight: bold; font-size: 1.1em; transition: transform 0.2s; }
    .contact-btn:hover { transform: scale(1.02); }
    .btn-wa { background: #25d366; } .btn-ph { background: #1565c0; } .btn-mp { background: #d32f2f; }
    
    /* === Ø§Ù„Ø´Ø§Øª Ø¨ÙˆØª Ø§Ù„Ø°ÙƒÙŠ (Gemini) === */
    .chat-widget-btn { position: fixed; bottom: 20px; left: 20px; background: #3e2723; color: white; padding: 10px 20px; border-radius: 30px; cursor: pointer; z-index: 2000; display:flex; align-items:center; gap:10px; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
    .chat-box { display: none; position: fixed; bottom: 80px; left: 20px; width: 320px; height: 500px; background: white; border: 1px solid #bf360c; border-radius: 15px; z-index: 2001; flex-direction: column; overflow: hidden; box-shadow: 0 5px 25px rgba(0,0,0,0.3); }
    .chat-header { background: #bf360c; color: white; padding: 10px 15px; text-align: right; display: flex; justify-content: space-between; align-items: center; }
    .chat-body { flex: 1; padding: 15px; overflow-y: auto; background: #fff8e1; display: flex; flex-direction: column; gap: 10px; }
    .bot-msg, .user-msg { padding: 10px 15px; border-radius: 15px; width: fit-content; max-width: 85%; font-size: 0.95em; line-height: 1.4; }
    .bot-msg { background: #fff; align-self: flex-end; border: 1px solid #ddd; border-top-right-radius: 2px; }
    .user-msg { background: #bf360c; color: white; align-self: flex-start; border-top-left-radius: 2px; }
    
    /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„ÙƒØªØ§Ø¨Ø© ÙˆØ§Ù„Ø£Ø²Ø±Ø§Ø± */
    .chat-footer { padding: 10px; background: #fff; border-top: 1px solid #ddd; }
    .chat-quick-actions { display: flex; gap: 5px; overflow-x: auto; padding-bottom: 8px; margin-bottom: 5px; scrollbar-width: none; }
    .chat-quick-actions::-webkit-scrollbar { display: none; }
    .chat-quick-actions button { background: #eee; color: #333; border: 1px solid #ddd; padding: 6px 12px; border-radius: 20px; cursor: pointer; font-size: 0.85em; white-space: nowrap; flex-shrink: 0; }
    .chat-quick-actions button:hover { background: #e0e0e0; }
    
    .chat-input-area { display: flex; gap: 5px; }
    .chat-input-area input { flex: 1; padding: 10px; border: 1px solid #ccc; border-radius: 25px; outline: none; }
    .chat-input-area button { background: #bf360c; color: white; border: none; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; }

    .welcome { padding:30px 20px; text-align:center; background: linear-gradient(to bottom, #ffe9c4, #fff3e0); border-bottom:3px solid #bf360c; }
    #counter { margin-top:15px; font-weight:bold; color:#bf360c; font-size:18px; background: rgba(255,255,255,0.5); padding: 5px; border-radius: 10px; display: inline-block; }

  </style>
</head>

<body>

<!-- Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© -->
<div id="customizeModal" class="modal">
  <div class="modal-content" style="text-align: right;">
    <span class="close-btn" onclick="closeCustomizeModal()">Ã—</span>
    <h3 style="color:#bf360c; text-align:center;">ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø³Ù†Ø¯ÙˆÙŠØ´ ğŸ¥™</h3>
    <div id="ingredientsList"></div>
    <button onclick="confirmAddToCart()" class="add-btn" style="margin-top:20px; background:#2e7d32;">ØªØ£ÙƒÙŠØ¯ ÙˆØ¥Ø¶Ø§ÙØ© âœ…</button>
  </div>
</div>

<div id="weightModal" class="modal">
  <div class="modal-content">
    <span class="close-btn" onclick="closeWeightModal()">Ã—</span>
    <h3 style="color:#bf360c;">Ø­Ø¯Ø¯ Ø§Ù„ÙƒÙ…ÙŠØ© (Ø§Ù„ÙˆØ²Ù†) âš–ï¸</h3>
    <div class="weight-grid">
      <div class="weight-option" onclick="selectWeight(200)">ÙˆÙ‚ÙŠØ© (200Øº)</div>
      <div class="weight-option" onclick="selectWeight(300)">ÙˆÙ‚ÙŠØ© ÙˆÙ†ØµÙ (300Øº)</div>
      <div class="weight-option" onclick="selectWeight(400)">ÙˆÙ‚ÙŠØªÙŠÙ† (400Øº)</div>
      <div class="weight-option" onclick="selectWeight(500)">Ù†ØµÙ ÙƒÙŠÙ„Ùˆ (500Øº)</div>
      <div class="weight-option" onclick="selectWeight(600)">3 ÙˆÙ‚ÙŠØ§Øª (600Øº)</div>
      <div class="weight-option" onclick="selectWeight(750)">ÙƒÙŠÙ„Ùˆ Ø¥Ù„Ø§ Ø±Ø¨Ø¹ (750Øº)</div>
      <div class="weight-option" onclick="selectWeight(800)">4 ÙˆÙ‚ÙŠØ§Øª (800Øº)</div>
      <div class="weight-option" onclick="selectWeight(1000)">ÙƒÙŠÙ„Ùˆ (1000Øº)</div>
    </div>
  </div>
</div>

<div id="clearCartModal" class="modal">
  <div class="modal-content">
    <span class="close-btn" onclick="closeClearCartModal()">Ã—</span>
    <h3 style="color:#3e2723;">ØªÙØ±ÙŠØº Ø§Ù„Ø³Ù„Ø©ØŸ</h3>
    <p>Ø£ÙƒÙŠØ¯ Ø¨Ø¯Ùƒ ØªØ­Ø°Ù ÙƒÙ„ Ø´ÙŠØŸ</p>
    <div style="display:flex; gap:10px; justify-content:center; margin-top:10px;">
      <button onclick="confirmClearCart()" style="background:#c62828; color:white; border:none; padding:10px 20px; border-radius:10px;">Ø­Ø°Ù</button>
      <button onclick="closeClearCartModal()" style="background:#777; color:white; border:none; padding:10px 20px; border-radius:10px;">Ø¥Ù„ØºØ§Ø¡</button>
    </div>
  </div>
</div>

<div id="emptyAlertModal" class="modal">
  <div class="modal-content">
    <span class="close-btn" onclick="closeEmptyAlertModal()">Ã—</span>
    <h3 style="color:#3e2723;">ÙŠØ§ ØºØ§Ù„ÙŠ!</h3>
    <p>Ø§Ù„Ø³Ù„Ø© Ø£ØµÙ„Ø§Ù‹ ÙØ§Ø±ØºØ© ğŸ˜…</p>
    <button onclick="closeEmptyAlertModal()" style="margin-top:15px; background:#bf360c; color:white; border:none; padding:10px 30px; border-radius:20px;">Ø¨Ø³ÙŠØ·Ø©</button>
  </div>
</div>

<!-- Ø§Ù„Ø³Ù„Ø© -->
<div id="cartModal" class="modal">
  <div class="modal-content">
    <span class="close-btn" onclick="toggleCart()">Ã—</span>
    <h3 style="color:#bf360c; border-bottom:1px solid #eee; padding-bottom:10px;">ğŸ›’ Ø³Ù„Ø© Ø·Ù„Ø¨Ø§ØªÙƒ</h3>
    <div style="text-align:left;"><button class="clear-cart-btn" onclick="openClearCartModal()"><i class="fa-solid fa-trash"></i> Ù…Ø­Ùˆ Ø§Ù„Ø¬Ù…ÙŠØ¹</button></div>
    <div id="cartItems" style="max-height: 300px; overflow-y: auto; margin-top:10px;"></div>
    <div style="border-top: 2px solid #bf360c; margin-top: 15px; padding-top: 10px;">
      <h3 style="text-align:center;">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹:</h3>
      <div style="display:flex; justify-content:space-between; font-weight:bold;">
        <span id="cartTotalLBP" style="color:#bf360c;">0 Ù„.Ù„</span>
        <span id="cartTotalUSD" style="color:#2e7d32;">$0.00</span>
      </div>
    </div>
    <button class="whatsapp-checkout" onclick="sendOrder()"><i class="fab fa-whatsapp"></i> Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨</button>
  </div>
</div>

<div class="cart-float" onclick="toggleCart()">
  <i class="fa-solid fa-cart-shopping"></i>
  <span id="cartCount">0</span>
</div>

<header>
  <h1>Ù…ÙŠØ¯Ùˆ Ù…Ù„Ùƒ Ø§Ù„Ø¨Ø³ØªØ±Ù…Ø§ ğŸ‘‘</h1>
  <p style="font-weight:bold;">Ø§Ù„Ø´ÙŠØ§Ø­ - Ø·Ø±ÙŠÙ‚ ØµÙŠØ¯Ø§ Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©</p>
  <p style="color:#ffe0b2; font-family:sans-serif;">Mido Malak El Basterma</p>
  <a href="https://www.dropbox.com/scl/fi/vnulwpoh2w2nvaw9kohun/midoapk.apk?rlkey=bcikn7zbfxxis6qol8ku9g1in&st=d6h7xa4a&dl=1" class="app-download-btn">
    <i class="fa-brands fa-android"></i> Ø§Ø¶ØºØ· Ù‡Ù†Ø§ Ù„ØªØ­Ù…ÙŠÙ„ ØªØ·Ø¨ÙŠÙ‚Ù†Ø§
  </a>
</header>

<div class="welcome">
  <div id="statusBox"></div>
  <div id="counter"></div>
</div>

<div style="text-align:center;"><div class="category-title">ğŸ¥™ Ù‚Ø³Ù… Ø§Ù„Ø³Ù†Ø¯ÙˆÙŠØ´Ø§Øª</div></div>
<div class="products" id="sandwichesContainer"></div>

<div style="text-align:center;"><div class="category-title">âš–ï¸ Ø£Ø³Ø¹Ø§Ø± Ø§Ù„ÙƒÙŠÙ„Ùˆ</div></div>
<div class="products" id="kiloContainer"></div>

<div style="text-align:center;"><div class="category-title">ğŸ¥¤ Ù…Ø´Ø±ÙˆØ¨Ø§Øª Ø¨Ø§Ø±Ø¯Ø©</div></div>
<div class="products" id="drinksContainer"></div>

<section class="contact-section">
  <h2 style="color:#bf360c;">ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§</h2>
  <a href="https://wa.me/96170359935" target="_blank" class="contact-btn btn-wa">ÙˆØ§ØªØ³Ø§Ø¨</a>
  <a href="tel:+9611382472" class="contact-btn btn-ph">Ø§ØªØµØ§Ù„ Ø£Ø±Ø¶ÙŠ</a>
  <a href="https://maps.app.goo.gl/47Fch33imeM5WQxm9" target="_blank" class="contact-btn btn-mp">Ø§Ù„Ù…ÙˆÙ‚Ø¹</a>
</section>

<!-- === Ø§Ù„Ø´Ø§Øª Ø¨ÙˆØª Ø§Ù„Ø°ÙƒÙŠ (Gemini 1.5 Flash) === -->
<div class="chat-widget-btn" onclick="toggleChat()"><i class="fa-solid fa-robot"></i> Ø§Ø³Ø£Ù„ Ù…ÙŠØ¯Ùˆ</div>
<div class="chat-box" id="chatBox">
  <div class="chat-header">
    <span>Ù…Ø³Ø§Ø¹Ø¯ Ù…ÙŠØ¯Ùˆ ğŸ¤–</span>
    <span style="cursor:pointer;" onclick="toggleChat()">Ã—</span>
  </div>
  <div class="chat-body" id="chatBody">
    <div class="bot-msg">Ø£Ù‡Ù„Ø§Ù‹ ÙŠØ§ ØºØ§Ù„ÙŠ! Ø£Ù†Ø§ Ø¬Ø§Ù‡Ø² Ù„Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø¹Ù† Ø£ÙŠ Ø³Ø¤Ø§Ù„ Ø¨ÙŠØ®Ø·Ø± Ø¨Ø¨Ø§Ù„Ùƒ Ø¹Ù† Ø§Ù„Ù…Ø·Ø¹Ù… Ø£Ùˆ Ø§Ù„Ø£ÙƒÙ„ ğŸ˜‹</div>
  </div>
  <div class="chat-footer">
    <div class="chat-quick-actions">
      <button onclick="sendQuickMsg('Ø´Ùˆ Ø§Ù„Ù…Ù†ÙŠÙˆØŸ')">ğŸ” Ø§Ù„Ù…Ù†ÙŠÙˆ</button>
      <button onclick="sendQuickMsg('ÙˆÙŠÙ† Ø§Ù„Ù…ÙˆÙ‚Ø¹ØŸ')">ğŸ“ Ø§Ù„Ù…ÙˆÙ‚Ø¹</button>
      <button onclick="sendQuickMsg('ÙÙŠ Ø¯Ù„ÙŠÙØ±ÙŠØŸ')">ğŸ›µ Ø¯Ù„ÙŠÙØ±ÙŠ</button>
      <button onclick="sendQuickMsg('Ø§Ù„Ù„Ø­Ù…Ø© Ø­Ù„Ø§Ù„ØŸ')">ğŸ¥© Ø§Ù„Ù„Ø­Ù…Ø©</button>
    </div>
    <div class="chat-input-area">
      <input type="text" id="userChatInput" placeholder="Ø§Ø³Ø£Ù„Ù†ÙŠ Ø£ÙŠ Ø´ÙŠ..." onkeypress="handleEnter(event)">
      <button onclick="sendMessage()"><i class="fa-solid fa-paper-plane"></i></button>
    </div>
  </div>
</div>

<script>
// ============================================
// Ù…ÙØªØ§Ø­ Google Gemini (ØªÙ… ØªØ«Ø¨ÙŠØªÙ‡)
// ============================================
const GEMINI_API_KEY = "AIzaSyBpb4tW1ZgW4g0tQnwSeXJ3ahIYTI46mzo"; 

const SYSTEM_PROMPT = `
Ø£Ù†Øª Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ Ù„Ù…Ø·Ø¹Ù… "Ù…ÙŠØ¯Ùˆ Ù…Ù„Ùƒ Ø§Ù„Ø¨Ø³ØªØ±Ù…Ø§" ÙÙŠ Ù„Ø¨Ù†Ø§Ù†.
ØªØ­Ø¯Ø« Ø¨Ø§Ù„Ù„Ù‡Ø¬Ø© Ø§Ù„Ù„Ø¨Ù†Ø§Ù†ÙŠØ© Ø§Ù„ÙˆØ¯ÙˆØ¯Ø© ÙˆØ§Ù„Ù…Ø­ØªØ±Ù…Ø©.
Ù…Ø¹Ù„ÙˆÙ…Ø§Øª:
- Ø§Ù„Ø§Ø³Ù…: Ù…ÙŠØ¯Ùˆ Ù…Ù„Ùƒ Ø§Ù„Ø¨Ø³ØªØ±Ù…Ø§.
- Ø§Ù„Ù…ÙˆÙ‚Ø¹: Ø§Ù„Ø´ÙŠØ§Ø­ - Ø·Ø±ÙŠÙ‚ ØµÙŠØ¯Ø§ Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©.
- Ø§Ù„ÙØ±ÙˆØ¹ Ø§Ù„Ø£Ø®Ø±Ù‰: Ø®Ù„Ø¯Ø©ØŒ Ø§Ù„Ø¬ÙŠÙ‘Ø©.
- Ø§Ù„Ø¯ÙˆØ§Ù…: 10 ØµØ¨Ø§Ø­Ø§Ù‹ Ø­ØªÙ‰ 11:30 Ù„ÙŠÙ„Ø§Ù‹.
- Ø§Ù„Ù„Ø­Ù…Ø©: Ø·Ø§Ø²Ø¬Ø© ÙˆØ­Ù„Ø§Ù„ 100%.
- Ø§Ù„Ø¯Ù„ÙŠÙØ±ÙŠ: Ù…ØªÙˆÙØ± Ù„ÙƒÙ„ Ø¨ÙŠØ±ÙˆØª.
Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø³Ø¹Ø§Ø± (Ø¨Ø§Ù„Ù„ÙŠØ±Ø©):
Ø¨Ø³ØªØ±Ù…Ø§/Ø±ÙˆØ³ØªÙˆ: 400,000 | Ø³Ø¬Ù‚/Ù…Ù‚Ø§Ù†Ù‚: 350,000 | Ù‡ÙˆØª Ø¯ÙˆØº: 300,000
ÙƒÙŠÙ„Ùˆ Ø¨Ø³ØªØ±Ù…Ø§/Ø±ÙˆØ³ØªÙˆ: 2,400,000 | ÙƒÙŠÙ„Ùˆ Ø³Ø¬Ù‚/Ù…Ù‚Ø§Ù†Ù‚: 1,300,000
Ù…Ø´Ø±ÙˆØ¨Ø§Øª: 80,000
ØªØ¹Ù„ÙŠÙ…Ø§Øª: Ø¬Ø§ÙˆØ¨ Ø¨Ø§Ø®ØªØµØ§Ø± ÙˆÙ…Ø±Ø­. Ù„Ø§ ØªØ®ØªØ±Ø¹ Ø£Ø³Ø¹Ø§Ø±.
`;

// ... (Ø¨Ø§Ù‚ÙŠ ÙƒÙˆØ¯ Ø§Ù„Ù…ØªØ¬Ø± ÙƒÙ…Ø§ Ù‡Ùˆ) ...
const RATE = 89000; 
const INGREDIENTS_SOUJOUK = ["Ù…Ø§ÙŠÙˆÙ†ÙŠØ²", "Ø®Ø±Ø¯Ù„", "Ø¨Ù†Ø¯ÙˆØ±Ø©", "ÙƒØ¨ÙŠØ³", "Ø­Ø§Ù…Ø¶"];
const INGREDIENTS_BASTERMA = ["Ù…Ø§ÙŠÙˆÙ†ÙŠØ²", "Ø®Ø±Ø¯Ù„", "Ø¨Ù†Ø¯ÙˆØ±Ø©", "ÙƒØ¨ÙŠØ³"];
const INGREDIENTS_ROSTO = ["Ù…Ø§ÙŠÙˆÙ†ÙŠØ²", "Ø®Ø±Ø¯Ù„", "Ø¨Ù†Ø¯ÙˆØ±Ø©", "ÙƒØ¨ÙŠØ³", "Ø®Ø³"];
const INGREDIENTS_HOTDOG = ["Ù…Ø§ÙŠÙˆÙ†ÙŠØ²", "Ø®Ø±Ø¯Ù„", "Ø¨Ù†Ø¯ÙˆØ±Ø©", "ÙƒØ¨ÙŠØ³", "Ø®Ø³", "ÙƒØ§ØªØ´Ø¨"];

const menuItems = [
  { id: 1, type: 'sandwich', name: "Ø³Ù†Ø¯ÙˆÙŠØ´ Ø¨Ø³ØªØ±Ù…Ø§", price: 400000, img: "https://midomido.neocities.org/bastermaa.jpg", ingredients: INGREDIENTS_BASTERMA },
  { id: 2, type: 'sandwich', name: "Ø±ÙˆØ³ØªÙˆ", price: 400000, img: "https://midomido.neocities.org/rostoo.jpg", ingredients: INGREDIENTS_ROSTO },
  { id: 4, type: 'sandwich', name: "Ø³Ù†Ø¯ÙˆÙŠØ´ Ø³Ø¬Ù‚", price: 350000, img: "https://midomido.neocities.org/soujoukk.jpg", ingredients: INGREDIENTS_SOUJOUK },
  { id: 5, type: 'sandwich', name: "Ø³Ù†Ø¯ÙˆÙŠØ´ Ù…Ù‚Ø§Ù†Ù‚", price: 350000, img: "https://midomido.neocities.org/makanekk.jpg", ingredients: INGREDIENTS_SOUJOUK },
  { id: 6, type: 'sandwich', name: "Ø³Ù†Ø¯ÙˆÙŠØ´ Ù‡ÙˆØª Ø¯ÙˆØº", price: 300000, img: "https://midomido.neocities.org/hot%20dogg.jpg", ingredients: INGREDIENTS_HOTDOG },
  { id: 7, type: 'kilo', name: "Ù„Ø­Ù…Ø© Ø¨Ø³ØªØ±Ù…Ø§", price: 2400000, img: null },
  { id: 8, type: 'kilo', name: "Ù„Ø­Ù…Ø© Ø±ÙˆØ³ØªÙˆ", price: 2400000, img: null },
  { id: 9, type: 'kilo', name: "Ù„Ø­Ù…Ø© Ø³Ø¬Ù‚", price: 1300000, img: null },
  { id: 10, type: 'kilo', name: "Ù„Ø­Ù…Ø© Ù…Ù‚Ø§Ù†Ù‚", price: 1300000, img: null },
  { id: 11, type: 'drink', name: "Ø¨ÙŠØ¨Ø³ÙŠ", price: 80000, img: "https://midomido.neocities.org/mido/%D8%A8%D9%8A%D8%A8%D8%B3%D9%8A.png" },
  { id: 12, type: 'drink', name: "Ø¨ÙŠØ¨Ø³ÙŠ Ø¯Ø§ÙŠØª", price: 80000, img: "https://midomido.neocities.org/mido/%D8%A8%D9%8A%D8%A8%D8%B3%D9%8A%20%D8%AF%D8%A7%D9%8A%D8%AA%20-7.jpeg" },
  { id: 13, type: 'drink', name: "Ø³ÙÙ† Ø¢Ø¨", price: 80000, img: "https://midomido.neocities.org/mido/%D8%B3%D9%81%D9%86%20%D8%A7%D8%A8.png" },
  { id: 14, type: 'drink', name: "Ø³ÙÙ† Ø¢Ø¨ Ø¯Ø§ÙŠØª", price: 80000, img: "https://midomido.neocities.org/mido/%D8%B3%D9%81%D9%86%20%D8%A7%D8%A8%20%D8%AF%D8%A7%D9%8A%D8%AA%20.png" },
  { id: 15, type: 'drink', name: "Ù…ÙŠØ±Ù†Ø¯Ø§", price: 80000, img: "https://midomido.neocities.org/mido/%D9%85%D9%8A%D8%B1%D9%86%D8%AF%D8%A7.png" },
  { id: 16, type: 'drink', name: "Ù„Ø¨Ù† Ø¹ÙŠØ±Ø§Ù†", price: 70000, img: "https://midomido.neocities.org/mido/%D9%84%D8%A8%D9%86.png" }
];

let cart = [];
let currentItemToCustomize = null;
let currentKiloItem = null;

function renderMenu() {
  const sandContainer = document.getElementById("sandwichesContainer");
  const kiloContainer = document.getElementById("kiloContainer");
  const drinksContainer = document.getElementById("drinksContainer");

  const createProductHTML = (item, btnText, btnAction) => {
    const usdPrice = (item.price / RATE).toFixed(2);
    let imgHTML = '';
    let cardClass = 'product';
    if (item.type !== 'kilo' && item.img) { imgHTML = `<img src="${item.img}" alt="${item.name}">`; } 
    else if (item.type === 'kilo') { cardClass += ' kilo-item'; }
    return `<div class="${cardClass}">${imgHTML}<h3>${item.name}</h3><div class="price-box"><span class="price-lbp">${item.price.toLocaleString('en-US')} Ù„.Ù„</span><span class="price-usd">$${usdPrice}</span></div><button class="add-btn" onclick="${btnAction}">${btnText}</button></div>`;
  };

  sandContainer.innerHTML = menuItems.filter(i => i.type === 'sandwich').map(item => createProductHTML(item, "Ø§Ø·Ù„Ø¨ ÙˆØ¹Ø¯Ù‘Ù„ ğŸ¥™", `prepareOrder(${item.id})`)).join('');
  kiloContainer.innerHTML = menuItems.filter(i => i.type === 'kilo').map(item => createProductHTML(item, "Ø­Ø¯Ø¯ Ø§Ù„ÙˆØ²Ù† âš–ï¸", `openWeightModal(${item.id})`)).join('');
  drinksContainer.innerHTML = menuItems.filter(i => i.type === 'drink').map(item => createProductHTML(item, "Ø£Ø¶Ù Ù„Ù„Ø³Ù„Ø© ğŸ¥¤", `addToCartDirect(${item.id})`)).join('');
}

function triggerCartAnimation() {
  const cartBtn = document.querySelector('.cart-float');
  cartBtn.classList.remove('cart-added-animation');
  void cartBtn.offsetWidth;
  cartBtn.classList.add('cart-added-animation');
}

function openClearCartModal() {
  if (cart.length === 0) { document.getElementById("emptyAlertModal").style.display = "block"; return; }
  document.getElementById("clearCartModal").style.display = "block";
}
function closeClearCartModal() { document.getElementById("clearCartModal").style.display = "none"; }
function closeEmptyAlertModal() { document.getElementById("emptyAlertModal").style.display = "none"; }
function confirmClearCart() { cart = []; updateCartUI(); closeClearCartModal(); }

function updateCartUI() {
  document.getElementById("cartCount").innerText = cart.length;
  const cartItemsDiv = document.getElementById("cartItems");
  let totalLBP = 0;
  if (cart.length === 0) { cartItemsDiv.innerHTML = "<p style='text-align:center;'>Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©</p>"; } 
  else {
    cartItemsDiv.innerHTML = cart.map((item, index) => {
      totalLBP += item.price;
      return `<div class="cart-item"><div style="display:flex; justify-content:space-between;"><strong>${item.name}</strong><span style="color:#bf360c; cursor:pointer;" onclick="removeFromCart(${index})">âŒ</span></div><span class="cart-notes">${item.notes}</span><div style="font-size:0.9em; color:#777;">${item.price.toLocaleString()} Ù„.Ù„</div></div>`;
    }).join('');
  }
  document.getElementById("cartTotalLBP").innerText = totalLBP.toLocaleString() + " Ù„.Ù„";
  document.getElementById("cartTotalUSD").innerText = "$" + (totalLBP / RATE).toFixed(2);
}

function removeFromCart(index) { cart.splice(index, 1); updateCartUI(); }

function prepareOrder(id) {
  const item = menuItems.find(p => p.id === id);
  currentItemToCustomize = item;
  const list = document.getElementById("ingredientsList");
  list.innerHTML = ""; 
  item.ingredients.forEach(ing => {
    list.innerHTML += `<label class="ingredient-option"><span>${ing}</span><input type="checkbox" value="${ing}" checked></label>`;
  });
  document.getElementById("customizeModal").style.display = "block";
}
function confirmAddToCart() {
  const checkboxes = document.querySelectorAll('#ingredientsList input[type="checkbox"]');
  let excluded = [];
  checkboxes.forEach(box => { if (!box.checked) excluded.push(box.value); });
  let noteText = excluded.length > 0 ? " (Ø¨Ø¯ÙˆÙ†: " + excluded.join("ØŒ ") + ")" : "";
  cart.push({ ...currentItemToCustomize, notes: noteText });
  closeCustomizeModal();
  updateCartUI();
  triggerCartAnimation(); 
}

function openWeightModal(id) {
  currentKiloItem = menuItems.find(p => p.id === id);
  document.getElementById("weightModal").style.display = "block";
}
function closeWeightModal() { document.getElementById("weightModal").style.display = "none"; }
function selectWeight(grams) {
  if (!currentKiloItem) return;
  let calculatedPrice = (currentKiloItem.price / 1000) * grams;
  let weightName = grams + "Øº";
  if (grams === 200) weightName = "ÙˆÙ‚ÙŠØ© (200Øº)";
  if (grams === 300) weightName = "ÙˆÙ‚ÙŠØ© ÙˆÙ†ØµÙ (300Øº)";
  if (grams === 400) weightName = "ÙˆÙ‚ÙŠØªÙŠÙ† (400Øº)";
  if (grams === 500) weightName = "Ù†ØµÙ ÙƒÙŠÙ„Ùˆ (500Øº)";
  if (grams === 600) weightName = "3 ÙˆÙ‚ÙŠØ§Øª (600Øº)";
  if (grams === 750) weightName = "ÙƒÙŠÙ„Ùˆ Ø¥Ù„Ø§ Ø±Ø¨Ø¹ (750Øº)";
  if (grams === 800) weightName = "4 ÙˆÙ‚ÙŠØ§Øª (800Øº)";
  if (grams === 1000) weightName = "ÙƒÙŠÙ„Ùˆ (1000Øº)";
  cart.push({ name: currentKiloItem.name, price: calculatedPrice, notes: `(ÙƒÙ…ÙŠØ©: ${weightName})`, img: null });
  closeWeightModal();
  updateCartUI();
  triggerCartAnimation(); 
}

function addToCartDirect(id) {
  const item = menuItems.find(p => p.id === id);
  cart.push({ ...item, notes: "" });
  updateCartUI();
  triggerCartAnimation(); 
}

function closeCustomizeModal() { document.getElementById("customizeModal").style.display = "none"; }
function toggleCart() {
  const modal = document.getElementById("cartModal");
  modal.style.display = (modal.style.display === "block") ? "none" : "block";
}

function sendOrder() {
  if (cart.length === 0) { document.getElementById("emptyAlertModal").style.display = "block"; return; }
  let message = "Ù…Ø±Ø­Ø¨Ø§ Ù…ÙŠØ¯ÙˆØŒ Ø·Ù„Ø¨ÙŠ Ù‡Ùˆ:%0a%0a";
  let total = 0;
  cart.forEach((item, index) => {
    message += `${index + 1}- ${item.name} ${item.notes}%0a`;
    total += item.price;
  });
  let usdTotal = (total / RATE).toFixed(2);
  message += `%0a*Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: ${total.toLocaleString()} Ù„.Ù„ (${usdTotal}$)*`;
  message += "%0a%0ağŸ“ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:";
  window.open(`https://wa.me/96170359935?text=${message}`, '_blank');
}

// ============================================
// Ø¯Ø§Ù„Ø© Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ (Gemini Chat)
// ============================================
function toggleChat() {
  const box = document.getElementById("chatBox");
  box.style.display = (box.style.display === "flex") ? "none" : "flex";
}

function handleEnter(e) {
  if(e.key === "Enter") sendMessage();
}

function sendQuickMsg(txt) {
  const input = document.getElementById("userChatInput");
  input.value = txt;
  sendMessage();
}

async function sendMessage() {
  const input = document.getElementById("userChatInput");
  const txt = input.value.trim();
  if(!txt) return;
  
  const body = document.getElementById("chatBody");
  body.innerHTML += `<div class="user-msg">${txt}</div>`;
  input.value = "";
  body.scrollTop = body.scrollHeight;

  const loadingId = "loading-" + Date.now();
  body.innerHTML += `<div class="bot-msg" id="${loadingId}">... Ø¹Ù… ÙÙƒÙ‘Ø± ...</div>`;
  body.scrollTop = body.scrollHeight;

  try {
    // Ù†Ø¯Ù…Ø¬ Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª Ù…Ø¹ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ø¹Ù…Ù„ Ø¹Ù„Ù‰ gemini-1.5-flash
    const finalPrompt = SYSTEM_PROMPT + "\n\nØ³Ø¤Ø§Ù„ Ø§Ù„Ø²Ø¨ÙˆÙ†: " + txt;

    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${GEMINI_API_KEY}`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        contents: [{ parts: [{ text: finalPrompt }] }]
      })
    });

    const data = await response.json();
    
    if (data.error) {
      document.getElementById(loadingId).remove();
      body.innerHTML += `<div class="bot-msg">Ø¹Ø°Ø±Ø§Ù‹ØŒ ÙÙŠ Ù…Ø´ÙƒÙ„Ø© ØªÙ‚Ù†ÙŠØ© Ø¨Ø³ÙŠØ·Ø© Ø­Ø§Ù„ÙŠØ§Ù‹.</div>`;
      console.error(data.error);
    } else {
      const reply = data.candidates[0].content.parts[0].text;
      document.getElementById(loadingId).remove();
      body.innerHTML += `<div class="bot-msg">${formatText(reply)}</div>`;
    }
    
  } catch (error) {
    document.getElementById(loadingId).remove();
    body.innerHTML += `<div class="bot-msg">Ø¹Ø°Ø±Ø§Ù‹ ÙŠØ§ ØºØ§Ù„ÙŠØŒ Ø§Ù„Ù†Øª Ø¹Ù†Ø¯ÙŠ Ø¶Ø¹ÙŠÙ Ø´ÙˆÙŠ. ÙÙŠÙƒ ØªØ¹ÙŠØ¯ Ø§Ù„Ø³Ø¤Ø§Ù„ØŸ</div>`;
    console.error(error);
  }
  
  body.scrollTop = body.scrollHeight;
}

function formatText(text) {
  return text.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>').replace(/\n/g, '<br>');
}

// ============================================
// ØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„Ø­Ø§Ù„Ø©
// ============================================
function updateVisitorCounter() {
  const BASE_COUNT = 1500;
  const today = new Date();
  const START_DATE = new Date('2025-12-02'); 
  const diffTime = today.getTime() - START_DATE.getTime();
  const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
  let accumulatedIncrease = 0;
  for (let i = 0; i <= diffDays; i++) {
      let d = new Date(START_DATE.getTime() + (i * 86400000));
      let seed = d.getDate() * 1000 + (d.getMonth() + 1) * 100 + d.getFullYear();
      seed = (seed * 9301 + 49297) % 233280;
      accumulatedIncrease += Math.floor((seed / 233280) * 11) + 20;
  }
  let finalCount = BASE_COUNT + accumulatedIncrease;
  const storageKey = 'mido_visited_today';
  if (localStorage.getItem(storageKey) !== today.toDateString()) {
    finalCount++;
    localStorage.setItem(storageKey, today.toDateString());
  }
  document.getElementById('counter').innerHTML = `ğŸ‘‘ Ø¹Ø¯Ø¯ Ø§Ù„Ø²ÙˆØ§Ø±: <strong>${finalCount.toLocaleString('en-US')}</strong>`;
}

function checkStatus() {
  let now = new Date().toLocaleString("en-US", {timeZone: "Asia/Beirut"});
  let h = new Date(now).getHours();
  let m = new Date(now).getMinutes();
  let open = (h > 10 || (h === 10 && m >= 0)) && (h < 23 || (h === 23 && m <= 30));
  document.getElementById("statusBox").innerHTML = open 
    ? '<span style="color:green; font-weight:bold; font-size:1.2em;">ğŸŸ¢ Ù…ÙØªÙˆØ­ Ø§Ù„Ø¢Ù† (Ø§Ø·Ù„Ø¨ Ø¯Ù„ÙŠÙØ±ÙŠ)</span>'
    : '<span style="color:red; font-weight:bold; font-size:1.2em;">ğŸ”´ Ù…ØºÙ„Ù‚ Ø§Ù„Ø¢Ù† (Ù†ÙØªØ­ 10 Øµ)</span>';
}

window.onclick = function(event) {
  if (event.target == document.getElementById("customizeModal")) closeCustomizeModal();
  if (event.target == document.getElementById("cartModal")) toggleCart();
  if (event.target == document.getElementById("clearCartModal")) closeClearCartModal();
  if (event.target == document.getElementById("emptyAlertModal")) closeEmptyAlertModal();
  if (event.target == document.getElementById("weightModal")) closeWeightModal();
}

renderMenu();
checkStatus();
updateVisitorCounter();
setInterval(updateVisitorCounter, 3600000); 
</script>

</body>
</html>